<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Curated Wikipedia Discoveries</title>
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
		<style>
         :root {
             --primary: #2563eb;
             --primary-dark: #1d4ed8;
             --background: #f8fafc;
             --card-bg: #ffffff;
             --text: #1a1a1a;
             --text-secondary: #64748b;
             --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
             --border: #e5e7eb;
         }

         body {
             font-family: system-ui, -apple-system, sans-serif;
             line-height: 1.6;
             margin: 0;
             padding: 20px;
             background-color: var(--background);
             color: var(--text);
             transition: background-color 0.3s;
         }

         .container {
             max-width: 900px;
             margin: 0 auto;
             padding: 32px;
             background: var(--card-bg);
             border-radius: 16px;
             box-shadow: var(--shadow);
         }

         header {
             text-align: center;
             margin-bottom: 40px;
         }

         h1 {
             font-size: 2.5rem;
             margin: 0;
             background: linear-gradient(135deg, var(--primary), var(--primary-dark));
             -webkit-background-clip: text;
             -webkit-text-fill-color: transparent;
             margin-bottom: 12px;
         }

         .subtitle {
             color: var(--text-secondary);
             font-size: 1.1rem;
         }

         .controls {
             display: flex;
             gap: 12px;
             justify-content: center;
             margin: 24px 0;
             flex-wrap: wrap;
         }

         button {
             padding: 12px 24px;
             background-color: var(--primary);
             color: white;
             border: none;
             border-radius: 8px;
             font-size: 1rem;
             cursor: pointer;
             transition: all 0.2s;
             display: flex;
             align-items: center;
             gap: 8px;
         }

         button:hover {
             background-color: var(--primary-dark);
             transform: translateY(-1px);
         }

         button:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             transform: none;
         }

         .article {
             background: var(--card-bg);
             border-radius: 12px;
             overflow: hidden;
             transition: all 0.3s;
         }

         .article-header {
             display: flex;
             align-items: center;
             justify-content: space-between;
             margin-bottom: 24px;
         }

         .article-title {
             font-size: 1.8rem;
             color: var(--primary);
             text-decoration: none;
             font-weight: 600;
             margin: 0;
         }

         .article-title:hover {
             text-decoration: underline;
         }

         .article-image-container {
             position: relative;
             margin: 24px 0;
             border-radius: 12px;
             overflow: hidden;
         }

         .article-image {
             width: 100%;
             max-height: 500px;
             object-fit: cover;
             transition: transform 0.3s;
         }

         .article-image:hover {
             transform: scale(1.02);
         }

         .article-summary {
             color: var(--text);
             font-size: 1.1rem;
             line-height: 1.8;
             margin: 24px 0;
         }

         .stats {
             display: flex;
             gap: 24px;
             margin-top: 24px;
             padding-top: 24px;
             border-top: 1px solid var(--border);
             color: var(--text-secondary);
         }

         .stat {
             display: flex;
             align-items: center;
             gap: 8px;
         }

         .loading {
             text-align: center;
             color: var(--text-secondary);
             padding: 40px;
             font-style: italic;
         }

         .error {
             padding: 16px;
             background-color: #fee2e2;
             border: 1px solid #ef4444;
             border-radius: 8px;
             color: #b91c1c;
             margin: 16px 0;
         }

         .search-container {
             position: relative;
             margin: 24px 0;
         }

         .search-input {
             width: 100%;
             padding: 12px 40px 12px 16px;
             border: 2px solid var(--border);
             border-radius: 8px;
             font-size: 1rem;
             background: var(--card-bg);
             color: var(--text);
             transition: all 0.2s;
         }

         .search-input:focus {
             outline: none;
             border-color: var(--primary);
             box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
         }

         .search-icon {
             position: absolute;
             right: 12px;
             top: 50%;
             transform: translateY(-50%);
             color: var(--text-secondary);
         }

         .articles-list {
             max-height: 600px;
             overflow-y: auto;
             border: 1px solid var(--border);
             border-radius: 8px;
             margin: 24px 0;
             scrollbar-width: thin;
             scrollbar-color: var(--primary) var(--background);
         }

         .articles-list::-webkit-scrollbar {
             width: 8px;
         }

         .articles-list::-webkit-scrollbar-track {
             background: var(--background);
         }

         .articles-list::-webkit-scrollbar-thumb {
             background-color: var(--primary);
             border-radius: 4px;
         }

         .list-item {
             padding: 16px;
             border-bottom: 1px solid var(--border);
             cursor: pointer;
             transition: all 0.2s;
         }

         .list-item:last-child {
             border-bottom: none;
         }

         .list-item:hover {
             background-color: var(--background);
         }

         .list-item h3 {
             margin: 0 0 8px 0;
             color: var(--primary);
         }

         .list-item p {
             margin: 0;
             color: var(--text-secondary);
             font-size: 0.9rem;
         }

         .view-mode-toggle {
             position: fixed;
             bottom: 24px;
             right: 24px;
             background: var(--primary);
             color: white;
             border-radius: 50%;
             width: 56px;
             height: 56px;
             display: flex;
             align-items: center;
             justify-content: center;
             cursor: pointer;
             box-shadow: var(--shadow);
             transition: all 0.2s;
             z-index: 1000;
         }

         .view-mode-toggle:hover {
             transform: scale(1.1);
         }

         .theme-toggle {
             position: absolute;
             top: 20px;
             right: 20px;
             background: none;
             border: none;
             color: var(--text);
             cursor: pointer;
             font-size: 1.2rem;
         }

         .keyboard-shortcuts {
             position: fixed;
             bottom: 24px;
             left: 24px;
             padding: 16px;
             background: var(--card-bg);
             border-radius: 8px;
             box-shadow: var(--shadow);
             color: var(--text-secondary);
             font-size: 0.9rem;
             z-index: 1000;
             opacity: 0;
             transition: opacity 0.3s;
         }

         .keyboard-shortcuts:hover {
             opacity: 1;
         }

         .keyboard-shortcuts kbd {
             background: var(--background);
             padding: 2px 6px;
             border-radius: 4px;
             margin: 0 4px;
         }

         [data-theme="dark"] {
             --primary: #60a5fa;
             --primary-dark: #3b82f6;
             --background: #1a1a1a;
             --card-bg: #2d2d2d;
             --text: #e5e7eb;
             --text-secondary: #9ca3af;
             --border: #404040;
         }

         @media (max-width: 768px) {
             .container {
                 padding: 20px;
             }

             h1 {
                 font-size: 2rem;
             }

             .article-title {
                 font-size: 1.5rem;
             }

             .keyboard-shortcuts {
                 display: none;
             }
         }

         .progress-bar {
             position: fixed;
             top: 0;
             left: 0;
             height: 3px;
             background: var(--primary);
             transition: width 0.3s;
             z-index: 1000;
         }

         .toast {
             position: fixed;
             bottom: 100px;
             left: 50%;
             transform: translateX(-50%);
             background: var(--card-bg);
             color: var(--text);
             padding: 12px 24px;
             border-radius: 8px;
             box-shadow: var(--shadow);
             opacity: 0;
             transition: opacity 0.3s;
         }

         .toast.show {
             opacity: 1;
         }
		</style>
	</head>
	<body>
		<div class="progress-bar" id="progressBar"></div>
		<div class="toast" id="toast"></div>
		<button class="theme-toggle" id="themeToggle">
			<i class="fas fa-moon"></i>
		</button>
		<div class="container">
			<header>
				<h1>Curated Wikipedia Discoveries</h1>
				<p class="subtitle">Explore fascinating and unusual articles from Wikipedia</p>
			</header>
			<div class="search-container">
				<input type="text" id="searchInput" class="search-input" placeholder="Search articles..." autocomplete="off">
				<i class="fas fa-search search-icon"></i>
			</div>
			<div id="content">
				<div class="loading">Discovering interesting articles...</div>
			</div>
			<div class="controls">
				<button id="randomButton" disabled>
					<i class="fas fa-random"></i>
					New Article
				</button>
				<button id="shareButton" disabled>
					<i class="fas fa-share-alt"></i>
					Share
				</button>
				<button id="listViewButton" disabled>
					<i class="fas fa-list"></i>
					Toggle List View
				</button>
			</div>
		</div>
		<div class="keyboard-shortcuts">
			Shortcuts:
			<kbd>R</kbd> Random
			<kbd>S</kbd> Share
			<kbd>L</kbd> List View
			<kbd>T</kbd> Theme
			<kbd>/</kbd> Search
		</div>

		<script>
         const content = document.getElementById('content');
         const randomButton = document.getElementById('randomButton');
         const shareButton = document.getElementById('shareButton');
         const themeToggle = document.getElementById('themeToggle');
         const searchInput = document.getElementById('searchInput');
         const listViewButton = document.getElementById('listViewButton');
         const progressBar = document.getElementById('progressBar');
         const toast = document.getElementById('toast');
         let articles = [];
         let articleSummaries = [];
         let currentArticle = null;
         let isListView = false;

         function showToast(message, duration = 3000) {
             toast.textContent = message;
             toast.classList.add('show');
             setTimeout(() => toast.classList.remove('show'), duration);
         }

         function updateProgressBar() {
             const scrolled = window.scrollY;
             const max = document.documentElement.scrollHeight - window.innerHeight;
             const width = `${(scrolled / max) * 100}%`;
             progressBar.style.width = width;
         }

         window.addEventListener('scroll', updateProgressBar);

         function toggleTheme() {
             const isDark = document.body.getAttribute('data-theme') === 'dark';
             document.body.setAttribute('data-theme', isDark ? 'light' : 'dark');
             themeToggle.innerHTML = `<i class="fas fa-${isDark ? 'moon' : 'sun'}"></i>`;
             localStorage.setItem('theme', isDark ? 'light' : 'dark');
             showToast(`${isDark ? 'Light' : 'Dark'} theme enabled`);
         }

         const savedTheme = localStorage.getItem('theme') || 'light';
         document.body.setAttribute('data-theme', savedTheme);
         themeToggle.innerHTML = `<i class="fas fa-${savedTheme === 'dark' ? 'sun' : 'moon'}"></i>`;
         themeToggle.addEventListener('click', toggleTheme);

         function showError(message) {
             content.innerHTML = `<div class="error">${message}</div>`;
             randomButton.disabled = false;
             shareButton.disabled = true;
             listViewButton.disabled = true;
         }

         function showLoading() {
             content.innerHTML = '<div class="loading">Discovering an interesting article...</div>';
             randomButton.disabled = true;
             shareButton.disabled = true;
         }

         async function getAllArticles() {
             try {
                 const response = await fetch(
                     "https://en.wikipedia.org/w/api.php?action=parse&origin=*&page=Wikipedia:Unusual_articles&prop=text&format=json"
                 );
                 const data = await response.json();
                 const regex = new RegExp("<b><a href=\\\"\/wiki\/(.*?)\"", "g");
                 articles = data.parse.text['*'].match(regex) || [];

                 if (articles.length > 0) {
                     randomButton.disabled = false;
                     listViewButton.disabled = false;
                     getRandomArticle();
                     await fetchAllArticleSummaries();
                 } else {
                     showError("No articles found. Please try refreshing the page.");
                 }
             } catch (err) {
                 showError("Failed to load articles. Please try refreshing the page.");
             }
         }

         async function fetchAllArticleSummaries() {
             for (const article of articles) {
                 try {
					 const articleTitle = article.substring(18, article.length - 1);
                     const response = await fetch(
                         `https://en.wikipedia.org/api/rest_v1/page/summary/${articleTitle}`
                     );
                     const summary = await response.json();
                     articleSummaries.push(summary);
                 } catch (err) {
                     console.error(`Failed to fetch summary for ${article}`);
                 }
             }
         }

         function displayArticlesList(filter = '') {
             const filteredArticles = articleSummaries.filter(article =>
                 article.title.toLowerCase().includes(filter.toLowerCase()) ||
																	   article.extract.toLowerCase().includes(filter.toLowerCase())
             );

             content.innerHTML = `
                 <div class="articles-list">
                     ${filteredArticles.map(article => `
             <div class="list-item" onclick="displayArticle(${JSON.stringify(article).replace(/"/g, '&quot;')})">
                            <h3>${article.title}</h3>
                            <p>${article.extract.slice(0, 150)}...</p>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function displayArticle(article) {
            currentArticle = article;
            content.innerHTML = `
                <article class="article">
                    <div class="article-header">
                        <a href="https://en.wikipedia.org/wiki/${article.title}"
                           target="_blank"
                           class="article-title">
                            ${article.title}
                        </a>
                    </div>
                    ${article.originalimage ?
                        `<div class="article-image-container">
                            <img src="${article.originalimage.source}"
                                 alt="${article.title}"
                                 class="article-image"
                                 loading="lazy">
                         </div>`
                        : ''}
                    <p class="article-summary">${article.extract}</p>
                    <div class="stats">
                        <div class="stat">
                            <i class="fas fa-book"></i>
                            Wikipedia Article
                        </div>
                        <div class="stat">
                            <i class="fas fa-clock"></i>
                            Updated ${new Date(article.timestamp).toLocaleDateString()}
                        </div>
                    </div>
                </article>
            `;
            shareButton.disabled = false;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        async function getRandomArticle() {
            showLoading();

            try {
                const randomIndex = Math.floor(Math.random() * articles.length);
                const articleTitle = articles[randomIndex].substring(18, articles[randomIndex].length - 1);

                const response = await fetch(
                    `https://en.wikipedia.org/api/rest_v1/page/summary/${articleTitle}`
                );
                currentArticle = await response.json();
                displayArticle(currentArticle);
                randomButton.disabled = false;
            } catch (err) {
                showError("Failed to load article. Please try again.");
            }
        }

        async function shareArticle() {
            if (!currentArticle) return;

            try {
                await navigator.share({
                    title: currentArticle.title,
                    text: currentArticle.extract,
                    url: `https://en.wikipedia.org/wiki/${currentArticle.title}`
                });
                showToast('Article shared successfully!');
            } catch (err) {
                navigator.clipboard.writeText(`${currentArticle.title}\n${currentArticle.extract}\n\nRead more: https://en.wikipedia.org/wiki/${currentArticle.title}`);
                showToast('Article link copied to clipboard!');
            }
        }

        function toggleView() {
            isListView = !isListView;
            if (isListView) {
                displayArticlesList(searchInput.value);
                showToast('List view enabled');
            } else {
                displayArticle(currentArticle);
                showToast('Single article view enabled');
            }
        }

        // Event listeners
        randomButton.addEventListener('click', getRandomArticle);
        shareButton.addEventListener('click', shareArticle);
        listViewButton.addEventListener('click', toggleView);

        let searchTimeout;
        searchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                if (isListView) {
                    displayArticlesList(e.target.value);
                }
            }, 300);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.target.tagName === 'INPUT') return;

            switch (e.key) {
                case 'r':
                    getRandomArticle();
                    break;
                case 's':
                    shareArticle();
                    break;
                case 'l':
                    toggleView();
                    break;
                case 't':
                    toggleTheme();
                    break;
                case '/':
                    e.preventDefault();
                    searchInput.focus();
                    break;
            }
        });

        // Initialize
        getAllArticles();
    </script>
</body>
</html>
